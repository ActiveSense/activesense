<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:viewModels="clr-namespace:ActiveSense.Desktop.ViewModels"
             xmlns:models="clr-namespace:ActiveSense.Desktop.Models"
             xmlns:ui="clr-namespace:FluentAvalonia.UI.Controls;assembly=FluentAvalonia"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="ActiveSense.Desktop.Views.AnalysisPageView"
             x:DataType="viewModels:AnalysisPageViewModel">

    <UserControl.Styles>
        <Style Selector="Border.card">
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="BoxShadow" Value="0 2 8 0 #15000000" />
            <Setter Property="Padding" Value="16" />
            <Setter Property="Margin" Value="0,0,0,16" />
        </Style>

        <Style Selector="TextBlock.heading">
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Margin" Value="0,0,0,12" />
        </Style>

        <Style Selector="ListBox">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Padding" Value="0" />
        </Style>

        <Style Selector="ui|TabView">
            <Setter Property="TabWidthMode" Value="SizeToContent" />
            <Setter Property="Background" Value="Transparent" />
        </Style>

        <Style Selector="ui|TabViewItem">
            <Setter Property="FontWeight" Value="Medium" />
        </Style>
    </UserControl.Styles>

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock Text="Analyse der Ergebnisse"
                   FontSize="24"
                   FontWeight="SemiBold"
                   Margin="0,0,0,16"
                   Grid.Row="0" />

        <Grid Grid.Row="1" ColumnDefinitions="*, 24, 280">
            <Border Classes="card" Grid.Column="0">
                <ui:TabView Grid.Row="0" Grid.Column="0"
                            AddTabButtonCommandParameter="Normal"
                            IsAddTabButtonVisible="False"
                            TabItems="{Binding TabItems}"
                            CanDragTabs="False"
                            AllowDropTabs="False">
                    <ui:TabView.TabItemTemplate>
                        <DataTemplate x:DataType="viewModels:TabItemTemplate">
                            <ui:TabViewItem Header="{Binding Name}"
                                            Content="{Binding Page}"
                                            IsClosable="False" />
                        </DataTemplate>
                    </ui:TabView.TabItemTemplate>
                </ui:TabView>
            </Border>

            <Rectangle Grid.Column="1" Fill="Transparent" />

            <Border Classes="card" Grid.Column="2">
                <Grid RowDefinitions="Auto, *">
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="8" Margin="0,0,0,12">
                        <ui:SymbolIcon Symbol="Document" VerticalAlignment="Center" />
                        <TextBlock Classes="heading" Text="Dateien" VerticalAlignment="Center" Margin="0" />
                    </StackPanel>

                    <Border Grid.Row="1"
                            Background="#F8F8F8"
                            CornerRadius="4"
                            Padding="8">
                        <ListBox ItemsSource="{Binding ResultFiles}"
                                 SelectionMode="Multiple"
                                 SelectionChanged="OnSelectionChanged"
                                 MinHeight="300">
                            <ListBox.ItemTemplate>
                                <DataTemplate x:DataType="models:Analysis">
                                    <Grid ColumnDefinitions="Auto, *" Margin="0,4">
                                        <ui:SymbolIcon Grid.Column="0" Symbol="Document" VerticalAlignment="Center" />
                                        <TextBlock Grid.Column="1"
                                                   Text="{Binding FileName}"
                                                   TextWrapping="Wrap"
                                                   VerticalAlignment="Center" />
                                    </Grid>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </Border>
                </Grid>
            </Border>
        </Grid>

        <Grid IsVisible="{Binding ShowSpinner}"
              Grid.Row="1"
              HorizontalAlignment="Center"
              VerticalAlignment="Center">
            <Border Background="#80FFFFFF"
                    CornerRadius="8"
                    Padding="24"
                    BoxShadow="0 4 16 0 #20000000">
                <StackPanel Spacing="12">
                    <ui:ProgressRing Width="48"
                                     Height="48"
                                     IsIndeterminate="True"
                                     HorizontalAlignment="Center" />
                    <TextBlock Text="Daten werden geladen..."
                               HorizontalAlignment="Center"
                               FontWeight="Medium" />
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</UserControl>